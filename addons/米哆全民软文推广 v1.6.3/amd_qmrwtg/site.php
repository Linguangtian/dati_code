<?php
 goto JXT7r; qT5ni: require_once '../addons/' . ARTICLE . '/WxPayPubHelper/WxPayPubHelper.php'; goto Rn0PH; Ucbof: define('COOKIE_FILE2', IA_ROOT . '/addons/' . ARTICLE . '/pic2.cookie'); goto Nygd6; JXT7r: defined('IN_IA') or exit('Access Denied'); goto NJ1ru; IB2Fk: defined('IN_IA') or exit('Access Denied'); goto Sg0c9; Nygd6: define('RES', '../addons/' . ARTICLE . '/style/'); goto qT5ni; NJ1ru: define('ARTICLE', 'amd_qmrwtg'); goto IB2Fk; Rn0PH: require_once '../addons/' . ARTICLE . '/oauth2.class.php'; goto EhO0T; RMutE: define('COOKIE_FILE1', IA_ROOT . '/addons/' . ARTICLE . '/pic1.cookie'); goto Ucbof; Sg0c9: define('COOKIE_FILE', IA_ROOT . '/addons/' . ARTICLE . '/pic.cookie'); goto RMutE; EhO0T: class amd_qmrwtgModuleSite extends WeModuleSite { public function findKJsetting() { goto xv8h8; VwRey: $tempappsecret = $_W['oauth_account']['secret']; goto mXLOQ; CzPVM: $kjsetting['shkey'] = $pay['wechat']['apikey']; goto KNqaq; mXLOQ: m6n13: goto IkPtY; dVkv2: $tempappid = $_W['account']['key']; goto XURRO; cg12A: $kjsetting['appsecret'] = $tempappsecret; goto L3JUI; rwMlW: $tempappid = $_W['oauth_account']['key']; goto VwRey; XURRO: $tempappsecret = $_W['account']['secret']; goto HmTXk; KNqaq: return $kjsetting; goto rmtlt; lbb8E: $tempuniacid = $_W['uniacid']; goto dVkv2; Tmeqz: $kjsetting['appid'] = $tempappid; goto cg12A; la0od: $setting = uni_setting($tempuniacid, array("payment")); goto z9Xk8; HmTXk: if (!($_W['account']['level'] < 4)) { goto m6n13; } goto OynES; z9Xk8: $pay = (array) $setting['payment']; goto Tmeqz; L3JUI: $kjsetting['mchid'] = $pay['wechat']['mchid']; goto CzPVM; xv8h8: global $_W; goto lbb8E; OynES: $tempuniacid = $_W['oauth_account']['acid']; goto rwMlW; IkPtY: $kjsetting = array(); goto la0od; rmtlt: } public function getUserInfo() { goto L3ysr; KIIYn: return $user_info; goto IHXnv; IHXnv: WicN_: goto qZJns; KC2RV: pdo_insert('amd_qmrwtg_user', $data); goto mAO4K; Jad9z: MHpOX: goto gp8fB; sTecK: return $user_info; goto ufnGm; yrGby: $db_user['uid'] = $db_user['uid']; goto ZDFA4; gp8fB: $data = array("openid" => $_W['openid'], "uniacid" => $_W['uniacid'], "nickname" => $user_info['nickname'], "avatar" => $user_info['headimgurl'], "createtime" => time(), "sex" => $user_info['sex'], "parentid" => intval($_GPC['advid']), "fopenid" => $_GPC['fopenid'], "last_update_time" => time()); goto ZP5kR; q3gNQ: $openid = $_W['fans']['openid']; goto VV7Q0; E9lBX: $cuser_info = $oauth2::setClientCookieUserInfo($user_info, $cookieKey); goto C0d_v; VV7Q0: $db_user = pdo_fetch('SELECT * FROM ' . tablename('amd_qmrwtg_user') . ' WHERE openid=:openid AND uniacid=:uniacid', array(":openid" => $openid, ":uniacid" => $_W['uniacid'])); goto pQFN4; Zd4jh: ygAIu: goto pTyUU; ZDFA4: $user_info = base64_decode($db_user); goto fID8i; L7gAq: $db_user['headimgurl'] = $db_user['avatar']; goto ZFNom; T6nHQ: $user_info = base64_decode($db_user); goto KIIYn; njryq: srCW1: goto eAkfd; vKum1: $user_info = base64_decode($cuser_info); goto sTecK; uVz7n: $user_info['uid'] = $db_user['id']; goto ywTDv; mWvGP: $oauth2 = new Oauth2($_W['oauth_account']); goto Io_oi; fID8i: return $user_info; goto mYAEB; Er0Rd: if (empty($db_user)) { goto WicN_; } goto L7gAq; IXfNA: $user_info = $oauth2->getOauthUserInfo($access_token['openid'], $access_token['access_token']); goto Y8bmG; ZP5kR: pdo_insert('amd_qmrwtg_user', $data); goto IWMxk; Kevm3: $cuser_info = $_GPC[$cookieKey]; goto UVmjo; K1jhy: $cookieKey = 'amd_qmrwtg_user_info3_' . $_W['uniacid']; goto Kevm3; IWMxk: $user_info['uid'] = pdo_insertid(); goto FxqCP; LjHG3: $redirect_uri = 'http://' . $_SERVER['HTTP_HOST'] . $_SERVER['PHP_SELF'] . '?' . $_SERVER['QUERY_STRING']; goto K1jhy; nTgRL: $oauth2->authorization_code($redirect_uri, Oauth2::$SCOPE_USERINFO, 'we7sid-' . $_W['session_id']); goto njryq; C0d_v: ANErg: goto vKum1; acKnm: $access_token = $oauth2->getOauthAccessToken($code); goto IXfNA; FxqCP: UuC_O: goto E9lBX; Y8bmG: $db_user = pdo_fetch('SELECT * FROM ' . tablename('amd_qmrwtg_user') . ' WHERE openid=:openid AND uniacid=:uniacid', array(":openid" => $user_info['openid'], ":uniacid" => $_W['uniacid'])); goto rC0os; pQFN4: if (!empty($db_user)) { goto ygAIu; } goto hYk1W; rC0os: if (empty($db_user)) { goto MHpOX; } goto uVz7n; eAkfd: $code = $_GPC['code']; goto acKnm; ywTDv: goto UuC_O; goto Jad9z; qZJns: HPIl3: goto yTkOl; mYAEB: oDVcO: goto LjHG3; yTkOl: goto oDVcO; goto Zd4jh; ZFNom: $db_user['uid'] = $db_user['uid']; goto T6nHQ; Io_oi: if (!empty($_GPC['code'])) { goto srCW1; } goto nTgRL; hYk1W: if (!(!empty($_W['fans']['avatar']) && !empty($_W['fans']['nickname']))) { goto HPIl3; } goto RwZq6; UVmjo: if (!empty($_GPC[$cookieKey])) { goto ANErg; } goto mWvGP; pTyUU: $db_user['headimgurl'] = $db_user['avatar']; goto yrGby; nTOhr: $uniacid = $_W['uniacid']; goto q3gNQ; L3ysr: global $_GPC, $_W; goto nTOhr; RwZq6: $data = array("openid" => $_W['openid'], "uniacid" => $_W['uniacid'], "nickname" => $_W['fans']['nickname'], "avatar" => $_W['fans']['avatar'], "createtime" => time(), "sex" => $_W['fans']['sex'], "parentid" => intval($_GPC['advid']), "fopenid" => $_GPC['fopenid'], "last_update_time" => time()); goto KC2RV; mAO4K: $db_user = pdo_fetch('SELECT * FROM ' . tablename('amd_qmrwtg_user') . ' WHERE openid=:openid AND uniacid=:uniacid', array(":openid" => $openid, ":uniacid" => $_W['uniacid'])); goto Er0Rd; ufnGm: } public function sendTplNotice($touser, $template_id, $postdata, $url = "", $topcolor = "#FF683F") { goto XzK16; DCiZW: $Account->sendTplNotice($touser, $template_id, $postdata, $url, $topcolor); goto w22iW; VicBv: $Account = WeAccount::create($_W['account']); goto DCiZW; XzK16: global $_W; goto VicBv; w22iW: } public function sendCustomNotice($openid, $msg, $url = "", $account = NULL) { goto vimvp; vNXog: TsnMu: goto r7R59; D3m8z: $content .= '<a href=\'' . $url . '\'>点击查看详情</a>'; goto ahcEu; hnhKk: foreach ($msg as $key => $value) { goto iNgbw; GNnxK: QcrBu: goto F6V5y; nwVCJ: $content .= $value['value'] . '
'; goto pM0ov; AgghK: $content .= '
'; goto GNnxK; rzSw2: mpdzu: goto IdkKE; F6V5y: goto WjtWA; goto HkK2B; Ds03E: $content .= $value['title'] . ':' . $value['value'] . '
'; goto tsgp0; pM0ov: if (!($key == 0)) { goto QcrBu; } goto AgghK; iNgbw: if (!empty($value['title'])) { goto prd1M; } goto nwVCJ; HkK2B: prd1M: goto Ds03E; tsgp0: WjtWA: goto rzSw2; IdkKE: } goto vNXog; K_Zbf: if (empty($url)) { goto VRPR4; } goto D3m8z; E4NQs: $content = ''; goto o_2BM; bh54N: if ($account) { goto fWGQo; } goto VQgZ7; r7R59: iUTK2: goto K_Zbf; nfyBg: fWGQo: goto E4NQs; UL8sM: XznSC: goto hnhKk; MmKyf: goto iUTK2; goto UL8sM; E2FeE: $account = WeAccount::create($_W['account']); goto PiinN; wQLb8: $content = $msg; goto MmKyf; o_2BM: if (is_array($msg)) { goto XznSC; } goto wQLb8; vimvp: if ($account) { goto dTTwP; } goto E2FeE; ahcEu: VRPR4: goto I_Oc7; VQgZ7: return NULL; goto nfyBg; PiinN: dTTwP: goto bh54N; I_Oc7: return $account->sendCustomNotice(array("touser" => $openid, "msgtype" => "text", "text" => array("content" => urlencode($content)))); goto eXiUK; eXiUK: } public function get_normal_url($action, $parametrs) { goto e_bda; RsxVP: $url = $_W['siteroot'] . 'app' . $temp_url; goto TWpHp; TWpHp: return $url; goto mRAdr; nmYEt: $temp_url = $this->createMobileUrl($action, $parametrs); goto MY3AI; MY3AI: $temp_url = substr($temp_url, 1); goto RsxVP; e_bda: global $_W; goto nmYEt; mRAdr: } public function build_order_sn() { return date('Ymd') . substr(implode(NULL, array_map('ord', str_split(substr(uniqid(), 7, 13), 1))), 0, 8); } public function getcurwebsite() { goto PF7wa; CE5bf: return $pageURL; goto WnUIo; OxN2o: if (!($_SERVER['HTTPS'] == 'on')) { goto cWk96; } goto bKsJ2; PWkyf: $pageURL .= '://' . $_SERVER['HTTP_HOST']; goto CE5bf; cp1pS: cWk96: goto PWkyf; bKsJ2: $pageURL .= 's'; goto cp1pS; PF7wa: $pageURL = 'http'; goto OxN2o; WnUIo: } public function pay_cash($openid, $fee) { goto n86Qp; Ya6ey: $pars['mchid'] = $kjsetting['mchid']; goto IH3Pv; SAFul: N2DRE: goto Yx2n_; UATmO: sOPu9: goto DzFIw; CVaC8: goto s1qD1; goto dnpKx; Yx2n_: $procResult = $resp; goto swC7c; EeUja: $url = 'https://api.mch.weixin.qq.com/mmpaymkttransfers/promotion/transfers'; goto ZRs2u; zq3sF: $procResult = array("errno" => 0, "error" => "success", "payment_no" => $payment_no); goto wLIIi; ZRs2u: $kjsetting = $this->findKJsetting(); goto y4Hxp; Tduuh: goto sKeSD; goto SAFul; x6sRH: $string1 .= 'key=' . $kjsetting['shkey']; goto iqkr6; l2l9u: $error = $xpath->evaluate('string(//xml/err_code_des)'); goto C6FU2; DzFIw: $payment_no = $xpath->evaluate('string(//xml/payment_no)'); goto zq3sF; nGUW6: $ret = $xpath->evaluate('string(//xml/result_code)'); goto mZJBl; m7EDe: $string1 = ''; goto vpkEg; JGBmc: if ($dom->loadXML($xml)) { goto Mvhsp; } goto tOpq4; mZJBl: if (strtolower($code) == 'success' && strtolower($ret) == 'success') { goto sOPu9; } goto l2l9u; ClkSF: $extras = array(); goto aZ_gK; dnpKx: Mvhsp: goto lbfpe; lbfpe: $xpath = new DOMXPath($dom); goto XjFpL; IH3Pv: $pars['nonce_str'] = random(32); goto WF0vK; x1icL: $arr = json_decode(json_encode((array) simplexml_load_string($resp['content'])), true); goto vtYMn; tVeI6: ksort($pars, SORT_STRING); goto m7EDe; kJWYj: $dom = new DOMDocument(); goto JGBmc; aZ_gK: $extras['CURLOPT_SSLCERT'] = MODULE_ROOT . '/cert/apiclient_cert_' . $_W['uniacid'] . '.pem'; goto E8HAc; E8HAc: $extras['CURLOPT_SSLKEY'] = MODULE_ROOT . '/cert/apiclient_key_' . $_W['uniacid'] . '.pem'; goto zRIOB; l7Gnj: KT211: goto x6sRH; WF0vK: $pars['partner_trade_no'] = time() . random(3, 1); goto SPRBv; kT0Fg: if (is_error($resp)) { goto N2DRE; } goto x1icL; zRIOB: $procResult = null; goto ijAwN; ijAwN: load()->func('communication'); goto nj_Df; SYgAm: return $procResult; goto YeTIb; C6FU2: $procResult = array("errno" => -2, "error" => $error); goto Md3De; tOpq4: $procResult = array("errno" => -1, "error" => "未知错误"); goto CVaC8; wLIIi: ojR24: goto eEYF2; Kfkr2: $pars['check_name'] = 'NO_CHECK'; goto W66cZ; Md3De: goto ojR24; goto UATmO; swC7c: sKeSD: goto SYgAm; XjFpL: $code = $xpath->evaluate('string(//xml/return_code)'); goto nGUW6; kGLl2: $pars['desc'] = '提现'; goto ihpNO; nj_Df: $resp = ihttp_request($url, $xml, $extras); goto kT0Fg; eEYF2: s1qD1: goto Tduuh; W66cZ: $pars['amount'] = $fee * 100; goto kGLl2; y4Hxp: $pars = array(); goto QZyK3; iqkr6: $pars['sign'] = strtoupper(md5($string1)); goto zhom8; ihpNO: $pars['spbill_create_ip'] = CLIENT_IP; goto tVeI6; vtYMn: $xml = '<?xml version="1.0" encoding="utf-8"?>' . $resp['content']; goto kJWYj; SPRBv: $pars['openid'] = $openid; goto Kfkr2; vpkEg: foreach ($pars as $k => $v) { $string1 .= "{$k}={$v}&"; IXmdn: } goto l7Gnj; n86Qp: global $_W; goto EeUja; zhom8: $xml = array2xml($pars); goto ClkSF; QZyK3: $pars['mch_appid'] = $kjsetting['appid']; goto Ya6ey; YeTIb: } function getdata($url, $type) { goto aqAk1; uHjt2: $url = trim($url); goto b3NC4; hwyPU: curl_setopt($ch, CURLOPT_COOKIEJAR, COOKIE_FILE); goto TZMui; UqU2a: curl_setopt($ch, CURLOPT_HEADER, 0); goto U1uHH; TKfoR: curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, true); goto TFhti; i2vVR: $ip = '27.' . mt_rand(0, 254) . '.' . mt_rand(0, 254) . '.' . mt_rand(0, 254); goto kh9OQ; HbaX5: curl_setopt($ch, CURLOPT_USERAGENT, 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36'); goto i2vVR; U1uHH: curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); goto I46h_; suFb9: OWp4a: goto tiruC; Oyh1x: curl_close($ch); goto lAov3; tiruC: $res = curl_exec($ch); goto Oyh1x; TZMui: curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1); goto HbaX5; aqAk1: global $_W, $_GPC; goto uHjt2; kh9OQ: if (empty($ip)) { goto OWp4a; } goto H5TL3; lAov3: return $res; goto Ikj63; TFhti: curl_setopt($ch, CURLOPT_COOKIEFILE, COOKIE_FILE); goto hwyPU; b3NC4: $ch = curl_init($url); goto UqU2a; I46h_: curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false); goto TKfoR; H5TL3: curl_setopt($ch, CURLOPT_HTTPHEADER, array('X-FORWARDED-FOR:' . $ip, 'CLIENT-IP:' . $ip)); goto suFb9; Ikj63: } function getdata1($url, $type) { goto Xf7yR; W1ZKc: if ($type == 1) { goto SSnVY; } goto MKUrd; MKUrd: if ($type == 2) { goto GeEmP; } goto ld4my; g5LFS: curl_close($ch); goto ibM08; yDx8i: goto hCeBD; goto tSsuz; L2A1U: SSnVY: goto Negr0; muLz8: curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false); goto UZuU5; ld4my: curl_setopt($ch, CURLOPT_COOKIEFILE, COOKIE_FILE); goto KV3AU; Nf5zt: curl_setopt($ch, CURLOPT_COOKIEFILE, COOKIE_FILE2); goto TsoId; A1v_y: curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1); goto hbc56; UZuU5: curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, true); goto W1ZKc; qV4Vf: $ch = curl_init($url); goto CfrSP; Xf7yR: global $_W, $_GPC; goto qV4Vf; i2NPU: curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); goto muLz8; Negr0: curl_setopt($ch, CURLOPT_COOKIEFILE, COOKIE_FILE1); goto yDx8i; KV3AU: goto hCeBD; goto L2A1U; tSsuz: GeEmP: goto Nf5zt; TsoId: hCeBD: goto A1v_y; hbc56: $res = curl_exec($ch); goto g5LFS; ibM08: return $res; goto zwXqu; CfrSP: curl_setopt($ch, CURLOPT_HEADER, 0); goto i2NPU; zwXqu: } function upimages($url) { goto dCEB_; gzIL4: curl_setopt($ch, CURLOPT_HEADER, 0); goto M6DhW; k_0oz: sTC0l: goto Aurda; G5QP1: $access_token = $accObj->fetch_available_token(); goto k_0oz; G5Qsr: if (!empty($_W['setting']['remote']['type'])) { goto DPDZW; } goto H6B4w; jCou6: if (is_dir($dir_name)) { goto ZcLa2; } goto n0n9b; n0n9b: $dir = mkdir($dir_name, 0777, true); goto qG7Bj; Ckz1v: $local_file = fopen($filepath, 'w'); goto B7St1; c_bQB: load()->classs('weixin.account'); goto bqpsX; Sd4NS: return 0; goto c82Ob; kcsHh: goto As5Z3; goto HDWwD; H6B4w: return $imagesinfo; goto kcsHh; NizMb: T1Yhl: goto Brofj; Ftwwk: GUDma: goto srBB2; ujklO: switch ($fileInfo['header']['content_type']) { case 'image/pjpeg': case 'image/jpeg': $extend = '.jpg'; goto ewkrb; case 'image/gif': $extend = '.gif'; goto ewkrb; case 'image/png': $extend = '.png'; goto ewkrb; default: $extend = '.jpg'; goto ewkrb; } goto eMdwC; eMdwC: q0mvG: goto ltNQI; WJzDn: $package = curl_exec($ch); goto tpPMN; zGOn4: rwzik: goto wYWqv; qkADn: if (false !== $dir) { goto s34Mb; } goto sl9Bk; ezcxs: $filename = date('YmdHis') . $this->createNoncestr(32) . $extend; goto TYn3Q; Wb6YH: $re_dir = "images/{$uniacid}/amd_qmrwtg/" . date('Y/m/'); goto lV9Xe; M6DhW: curl_setopt($ch, CURLOPT_NOBODY, 0); goto mttU3; sl9Bk: return 0; goto e9JlV; N6dzB: h3DTg: goto Ftwwk; TYn3Q: $uniacid = intval($_W['uniacid']); goto Wb6YH; qG7Bj: ZcLa2: goto qkADn; exh5A: fclose($local_file); goto jQptM; l4wON: bAf3t: goto N6dzB; xjBjT: if (!($_W['account']['level'] >= 3)) { goto sTC0l; } goto c_bQB; KCPpa: curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, FALSE); goto Tbyhl; B7St1: if (false !== $local_file) { goto rwzik; } goto Sd4NS; Aurda: $ch = curl_init($url); goto gzIL4; mttU3: curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE); goto KCPpa; J_adD: if (!empty($fileInfo['header']['content_type'])) { goto FxACF; } goto dBvv4; Tzb20: XEe3J: goto nTeAO; dBvv4: return $url; goto lve91; RcEVK: return $imagesinfo; goto qU3BJ; Brofj: $fileInfo = array_merge(array("header" => $httpinfo), array("body" => $package)); goto ujklO; o2XV0: s34Mb: goto Ckz1v; c82Ob: goto h3DTg; goto zGOn4; HbvWX: $rejson = json_decode($package, true); goto Bh21r; Bh21r: if (empty($rejson['errcode'])) { goto T1Yhl; } goto UvRCz; Tbyhl: curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); goto WJzDn; UXZoR: As5Z3: goto l4wON; e9JlV: goto GUDma; goto o2XV0; Z4bQI: $filepath = $dir_name . $filename; goto dciqS; lV9Xe: $dir_name = ATTACHMENT_ROOT . $re_dir; goto Z4bQI; jQptM: $imagesinfo = $re_dir . $filename; goto G5Qsr; AiuU9: curl_close($ch); goto HbvWX; UvRCz: return 0; goto NizMb; tpPMN: $httpinfo = curl_getinfo($ch); goto AiuU9; HDWwD: DPDZW: goto BUdYV; wYWqv: if (!(false !== fwrite($local_file, $filecontent))) { goto bAf3t; } goto exh5A; dciqS: $filecontent = $fileInfo['body']; goto jCou6; bqpsX: $accObj = new WeixinAccount(); goto G5QP1; BUdYV: load()->func('file'); goto pJKg_; nTeAO: ZCgQ1: goto UXZoR; nGALV: if (is_error($remotestatus)) { goto XEe3J; } goto zFSHC; lve91: FxACF: goto ezcxs; qU3BJ: goto ZCgQ1; goto Tzb20; ltNQI: ewkrb: goto J_adD; dCEB_: global $_W, $_GPC; goto xjBjT; pJKg_: $remotestatus = file_remote_upload($imagesinfo, true); goto nGALV; zFSHC: file_delete($imagesinfo); goto RcEVK; srBB2: } private function createNonceStr($length = 16) { goto VHU5q; tfTY5: g5e69: goto tTOZ_; Qx3w9: $i = 0; goto KlJl3; KlJl3: cliT6: goto LxQ18; iF8AN: return $str; goto aWJbO; QtPwz: $str .= substr($chars, mt_rand(0, strlen($chars) - 1), 1); goto tfTY5; ZFXWU: goto cliT6; goto LOEUr; LxQ18: if (!($i < $length)) { goto rpEJt; } goto QtPwz; tTOZ_: $i++; goto ZFXWU; qSh1J: $str = ''; goto Qx3w9; LOEUr: rpEJt: goto iF8AN; VHU5q: $chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'; goto qSh1J; aWJbO: } function cj_yp($content_base) { goto s9I3h; C9v7V: $start = strpos($constr, '<mpvoice'); goto gD3WD; Ik4M3: $constr = $content_base; goto h06ht; jBAI6: if (strpos($constr, '<mpvoice')) { goto lEHEx; } goto reOLU; a_lO1: goto pmzrW; goto vkRFp; fXDUt: $i++; goto tazEr; uuzko: return $content_base; goto Upa2A; gKQkP: if (!($i < 100)) { goto QkQn4; } goto jBAI6; reOLU: $i = 100; goto a_lO1; h06ht: $conarr = array(); goto eWvW5; b0Dbt: pmzrW: goto ukEp0; pQJU6: $settings = $this->module['config']; goto Ik4M3; eloRV: $stop = strpos($constr, 'mpvoice>') + 8; goto jTuyW; gHNfj: I4515: goto uuzko; gD3WD: $constr = substr($constr, $start); goto eloRV; i2Zoe: $content_base = str_replace('<strong>听他的声音｜ 会上瘾<mpvoice', '<mpvoice', $content_base); goto SFG_s; NOtIg: QkQn4: goto CmVz0; tazEr: goto cSqcK; goto NOtIg; ukEp0: DePbi: goto fXDUt; CmVz0: foreach ($conarr as $key => $value) { goto FKiIc; zqGY6: $mid = substr($mid, $start); goto S27_y; u3OMk: $start = strpos($mid, 'fileid="') + 8; goto zqGY6; cdkIn: $mname = substr($mname, $start); goto b0sAl; giGVE: $mname = $value; goto a9Zw9; WL7Pg: $mid = substr($mid, 0, $stop); goto yQ1AE; S27_y: $stop = strpos($mid, '"'); goto WL7Pg; yQ1AE: unset($mname); goto giGVE; b0sAl: $stop = strpos($mname, '"'); goto z0EOL; aYF5_: h9bqt: goto MH3_J; a9Zw9: $start = strpos($mname, 'ame="') + 5; goto cdkIn; HH5eV: $content_base = str_replace($value, '<section class="weixinAudio"><audio src="https://res.wx.qq.com/voice/getvoice?mediaid=' . $mid . '" id="media" width="1" height="1" preload=""></audio><section id="audio_area" class="share_audio_context flex_context pages_reset"><section class="share_audio_switch"><em class="icon_share_audio_switch" role="button"></em></section><section class="share_audio_info flex_bd"><strong class="share_audio_title" role="link">' . $mname . '</strong><p class="share_audio_tips">公众号：' . $settings['appid_title'] . '</p><section class="share_audio_progress_wrp"><section class="share_audio_progress"><section id="audio_progress" style="width:0%" class="share_audio_progress_inner"></section><section class="share_audio_progress_buffer" style="width:0%;"></section><section class="share_audio_progress_loading" style="display:none;"><section class="share_audio_progress_loading_inner"></section></section></section><span id="audio_progress1" class="share_audio_progress_handle" style="display:none;left:0%;"></span></section><section class="share_audio_desc" aria-labelledby="时长"><em id="audio_length1" class="share_audio_length_current" aria-hidden="true" style="font-style:normal">00:00</em> <em id="audio_length" class="share_audio_length_total" style="font-style:normal">00:00</em></section></section></section></section>', $content_base); goto aYF5_; FKiIc: unset($mid); goto zrO2n; z0EOL: $mname = substr($mname, 0, $stop); goto HH5eV; zrO2n: $mid = $value; goto u3OMk; MH3_J: } goto gHNfj; jTuyW: $conarr[$i] = substr($constr, 0, $stop); goto b0Dbt; SFG_s: $content_base = str_replace('</mpvoice></strong>', '</mpvoice>', $content_base); goto pQJU6; eWvW5: $i = 0; goto zjQni; vkRFp: lEHEx: goto C9v7V; s9I3h: global $_W, $_GPC; goto i2Zoe; zjQni: cSqcK: goto gKQkP; Upa2A: } function imgbdh($url, $type) { goto eYHau; tWDTu: if (is_dir($dir_name)) { goto gMwUe; } goto prtWT; pV5UE: $dir_name = ATTACHMENT_ROOT . $re_dir; goto v0gjk; Rakcj: if (!(false !== fwrite($local_file, $filecontent))) { goto cLvXB; } goto Q04Ce; Cn39B: gMwUe: goto pNXnW; vnPV4: load()->func('file'); goto uaq5e; wd_W7: g2SJL: goto nRMaU; tyocG: $access_token = $accObj->fetch_available_token(); goto awLJD; JmCNM: xGPnq: goto l1N_7; bTUYN: jeVFE: goto Rakcj; i4NL6: curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE); goto WqWMF; GvjX0: OWJ58: goto MslLP; lWW2a: $accObj = new WeixinAccount(); goto tyocG; q4QkJ: switch ($fileInfo['header']['content_type']) { case 'image/pjpeg': case 'image/jpeg': $extend = '.jpg'; goto g2SJL; case 'image/gif': $extend = '.gif'; goto g2SJL; case 'image/png': $extend = '.png'; goto g2SJL; } goto NrTYB; awLJD: jHOt2: goto b9lPt; uaq5e: $remotestatus = file_remote_upload($imagesinfo, true); goto Y_MBt; wN812: cLvXB: goto GvjX0; MslLP: GD2LC: goto h_Yq2; pNXnW: if (false !== $dir) { goto eJfua; } goto hZ8H8; HD29p: curl_setopt($ch, CURLOPT_HEADER, 0); goto M3qjU; CR4nG: goto M3_Jw; goto JmCNM; M3qjU: curl_setopt($ch, CURLOPT_NOBODY, 0); goto i4NL6; aYTkA: if (false !== $local_file) { goto jeVFE; } goto xhjIY; xQBrX: $re_dir = "images/{$uniacid}/amd_qmrwtg/" . $type . '/' . date('Y/m/'); goto pV5UE; Y_MBt: if (is_error($remotestatus)) { goto xGPnq; } goto rlsiH; PpRcy: if (empty($rejson['errcode'])) { goto yds59; } goto ofhJj; Q04Ce: fclose($local_file); goto OwhzR; vrnZq: I3cxy: goto vnPV4; wXIGB: goto GD2LC; goto SC_Ny; b9lPt: $ch = curl_init($url); goto HD29p; J18yP: $filecontent = $fileInfo['body']; goto tWDTu; ZhYuK: $local_file = fopen($filepath, 'w'); goto aYTkA; WqWMF: curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, FALSE); goto xzmtc; ofhJj: return 0; goto FyD3a; xzmtc: curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); goto Em2mh; wdoQE: return $imagesinfo; goto CR4nG; nRMaU: $filename = date('YmdHis') . $this->createNoncestr(8) . $extend; goto A374F; FXScC: return $imagesinfo; goto Q0k3c; g4oVq: if (!($_W['account']['level'] >= 3)) { goto jHOt2; } goto WbTEB; NrTYB: PC6Qh: goto wd_W7; v0gjk: $filepath = $dir_name . $filename; goto J18yP; QoOV8: $fileInfo = array_merge(array("header" => $httpinfo), array("body" => $package)); goto q4QkJ; rlsiH: file_delete($imagesinfo); goto wdoQE; eE7WH: $httpinfo = curl_getinfo($ch); goto zsdFa; SC_Ny: eJfua: goto ZhYuK; prtWT: $dir = mkdir($dir_name, 0777, true); goto Cn39B; A374F: $uniacid = intval($_W['uniacid']); goto xQBrX; q_IF5: DyNNL: goto wN812; LNlwj: goto OWJ58; goto bTUYN; Em2mh: $package = curl_exec($ch); goto eE7WH; xhjIY: return 0; goto LNlwj; TRlcO: $url = trim($url); goto g4oVq; hZ8H8: return 0; goto wXIGB; OwhzR: $imagesinfo = $re_dir . $filename; goto BwhZA; eYHau: global $_W, $_GPC; goto TRlcO; FyD3a: yds59: goto QoOV8; BwhZA: if (!empty($_W['setting']['remote']['type'])) { goto I3cxy; } goto FXScC; vxauK: $rejson = json_decode($package, true); goto PpRcy; WbTEB: load()->classs('weixin.account'); goto lWW2a; zsdFa: curl_close($ch); goto vxauK; l1N_7: M3_Jw: goto q_IF5; Q0k3c: goto DyNNL; goto vrnZq; h_Yq2: } function getstrarr($start_str, $stop_str, $text, $string) { goto d6x5Q; Y2O0S: mK7tR: goto PpXqO; uC8_e: $i = 200; goto S2Aak; TzC8U: goto ebgXs; goto QFbQJ; Ii_Jc: $arr = array(); goto zKUNZ; d6x5Q: $str = $string; goto Ii_Jc; hyrhv: if (strpos('tech' . $str, $start_str)) { goto JpDHK; } goto uC8_e; zKUNZ: $i = 0; goto qy_HI; QFbQJ: v1xat: goto SsjZT; N2Hnx: $arr[$i] = substr($str, 0, $stop); goto GQ10F; qy_HI: ebgXs: goto cYHo8; SsjZT: foreach ($arr as $key => $value) { $string = str_replace($value, $text, $string); wARjP: } goto Y2O0S; ZFLsl: $i++; goto TzC8U; S2Aak: goto SkaF2; goto dF_8q; ietnz: $str = substr($str, $start); goto zt7eW; cYHo8: if (!($i < 200)) { goto v1xat; } goto hyrhv; GQ10F: $str = substr($str, $stop); goto ZEjl2; ulezE: $start = strpos($str, $start_str); goto ietnz; dF_8q: JpDHK: goto ulezE; ZEjl2: SkaF2: goto eSoCW; PpXqO: return $string; goto KWDMu; eSoCW: nRoqy: goto ZFLsl; zt7eW: $stop = strpos($str, $stop_str) + strlen($stop_str); goto N2Hnx; KWDMu: } public function doWebcreatecode() { goto dFBuK; VBPrw: $errorCorrectionLevel = 'L'; goto PEX2g; jZmOl: load()->library('qrcode'); goto X7KuB; X7KuB: $content = $_GPC['url']; goto LCeut; jj69S: exit; goto Qdumo; LCeut: $size = 5; goto VBPrw; dFBuK: global $_W, $_GPC; goto jZmOl; PEX2g: $code = QRcode::png($content, false, $errorCorrectionLevel, $size); goto P2Zcy; P2Zcy: echo $code; goto jj69S; Qdumo: } } ?>